# Раздел сделок

## Интерфейс

Каждый пользователь должен иметь возможность вносить свои сделки. Ссылка на страницу сделок должна быть в шапке таблицы рядом с логином пользователя.

На странице сделок должна отображать таблицы сделок пользователя, также должна быть возможность добавить новую сделку и удалить существующую (как строку в таблице).
Новая сделка должна добавлять интерактивно как строка в верхней части таблицы. Также должна быть возможность отредактировать существующую сделку (все поля), также как строку в таблице.

Внешний вид страницы и таблицы должен быть аналогичен странице основного рейтинга.

## Структура данных

У каждой сделки должны быть следующие атрибуты:

| Атрибут            | Описание                                                                                                                                      |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| Дата покупки       | Текущая дата в момент добавления сделки, есть возможность изменить дату при создании сделки                                                   |
| Тикет              | Выпадающий список с автодополнением из существующих ISIN в БД (tbank_bonds)                                                                   |
| Название           | Имя бренда                                                                                                                                    |
| Рейтинг            | Рейтинг в момент создания сделки, при изменении даты сделки выдавать предупреждение                                                           |
| Размер купона      | Размер купона из БД (moex_bonds)                                                                                                              |
| Период             | Купонный период из БД (moex_bonds)                                                                                                            |                                                                      |
| Погашение          | Дата погашения, при создании сделки проставляется либо датой погашения, либо, если есть оферта, пользователь может выбрать проставить её дату |
| Погашение / оферта | Флажок, показывающий считать показатели к дате оферты или к дате погашения                                                                    |
| Цена               | Текущая цена из БД (tbank_prices) с возможностью изменения при создании сделки                                                                |
| НКД                | НКД на дату создания сделки (если дата не текущая, то пересчитать)                                                                            |
| Комиссия           | Комиссия из настроек пользователя с возможностью изменения, для оферты умножается на 2                                                        |
| Итого затраты      | Общие затраты на номинал, НКД и комиссию                                                                                                      |
| Номинал            | Номинал из БД (moex_bonds)                                                                                                                    |
| Купон              | Купон из БД (moex_bonds)                                                                                                                      |
| Итого доход        | Доход как сумма номинала и купона, рассчитывается после создания сделки                                                                       |
| Чистая прибыль     | Разница между доходом и затратами, рассчитывается после создания сделки                                                                       |
| Годовая доходность | Годовая доходность рассчитывается аналогично доходности в рейтинге (учитывается к погашению или к оферте выбрано в сделке)                    |
